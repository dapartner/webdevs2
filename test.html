<html>
    <head>
        <title>Towed Car Data </title>
    <link id="load-css-0" rel="stylesheet" type="text/css" href="https://www.gstatic.com/charts/45.1/css/core/tooltip.css"><link id="load-css-1" rel="stylesheet" type="text/css" href="https://www.gstatic.com/charts/45.1/css/util/util.css"><script type="text/javascript" charset="UTF-8" src="https://www.gstatic.com/charts/45.1/js/jsapi_compiled_format_module.js"></script><script type="text/javascript" charset="UTF-8" src="https://www.gstatic.com/charts/45.1/js/jsapi_compiled_default_module.js"></script><script type="text/javascript" charset="UTF-8" src="https://www.gstatic.com/charts/45.1/js/jsapi_compiled_ui_module.js"></script><script type="text/javascript" charset="UTF-8" src="https://www.gstatic.com/charts/45.1/js/jsapi_compiled_corechart_module.js"></script></head>
    <body>
        <h1>Towed Car Data</h1>
        <button id="submit">Submit</button>
        <div id="results"><div style="position: relative;"><div dir="ltr" style="position: relative; width: 400px; height: 300px;"><div aria-label="A chart." style="position: absolute; left: 0px; top: 0px; width: 100%; height: 100%;"><svg width="400" height="300" aria-label="A chart." style="overflow: hidden;"><defs id="defs"></defs><rect x="0" y="0" width="400" height="300" stroke="none" stroke-width="0" fill="#ffffff"></rect><g><text text-anchor="start" x="77" y="25.85" font-family="Arial" font-size="11" font-weight="bold" stroke="none" stroke-width="0" fill="#000000">Towed cars by color on</text><text text-anchor="start" x="77" y="39.85" font-family="Arial" font-size="11" font-weight="bold" stroke="none" stroke-width="0" fill="#000000">2017-02-17T00:00:00.000</text><rect x="77" y="16.5" width="247" height="25" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect></g><g><rect x="248" y="58" width="76" height="137" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g><rect x="248" y="58" width="76" height="11" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g><text text-anchor="start" x="263" y="67.35" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#222222">Black</text></g><circle cx="253.5" cy="63.5" r="5.5" stroke="none" stroke-width="0" fill="#3366cc"></circle></g><g><rect x="248" y="76" width="76" height="11" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g><text text-anchor="start" x="263" y="85.35" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#222222">White</text></g><circle cx="253.5" cy="81.5" r="5.5" stroke="none" stroke-width="0" fill="#dc3912"></circle></g><g><rect x="248" y="94" width="76" height="11" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g><text text-anchor="start" x="263" y="103.35" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#222222">Grey</text></g><circle cx="253.5" cy="99.5" r="5.5" stroke="none" stroke-width="0" fill="#ff9900"></circle></g><g><rect x="248" y="112" width="76" height="11" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g><text text-anchor="start" x="263" y="121.35" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#222222">Silver</text></g><circle cx="253.5" cy="117.5" r="5.5" stroke="none" stroke-width="0" fill="#109618"></circle></g><g><rect x="248" y="130" width="76" height="11" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g><text text-anchor="start" x="263" y="139.35" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#222222">Green</text></g><circle cx="253.5" cy="135.5" r="5.5" stroke="none" stroke-width="0" fill="#990099"></circle></g><g><rect x="248" y="148" width="76" height="11" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g><text text-anchor="start" x="263" y="157.35" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#222222">Blue</text></g><circle cx="253.5" cy="153.5" r="5.5" stroke="none" stroke-width="0" fill="#0099c6"></circle></g><g><rect x="248" y="166" width="76" height="11" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g><text text-anchor="start" x="263" y="175.35" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#222222">Red</text></g><circle cx="253.5" cy="171.5" r="5.5" stroke="none" stroke-width="0" fill="#dd4477"></circle></g><g><rect x="248" y="184" width="76" height="11" stroke="none" stroke-width="0" fill-opacity="0" fill="#ffffff"></rect><g><text text-anchor="start" x="263" y="193.35" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#222222">Other</text></g><circle cx="253.5" cy="189.5" r="5.5" stroke="none" stroke-width="0" fill="#66aa00"></circle></g></g><g><path d="M154,151L154,75A76,76,0,0,1,229.28738058575846,140.61682492995718L154,151A0,0,0,0,0,154,151" stroke="#ffffff" stroke-width="1" fill="#3366cc"></path><text text-anchor="start" x="171.46108142597373" y="117.03114051564671" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#ffffff">22.8%</text></g><g><path d="M154,151L229.28738058575846,140.61682492995718A76,76,0,0,1,192.23105474885807,216.68398931847713L154,151A0,0,0,0,0,154,151" stroke="#ffffff" stroke-width="1" fill="#dc3912"></path><text text-anchor="start" x="182.21890567049246" y="176.14778369920384" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#ffffff">18.8%</text></g><g><path d="M154,151L106.5253413432591,91.65223858117362A76,76,0,0,1,154,75L154,151A0,0,0,0,0,154,151" stroke="#ffffff" stroke-width="1" fill="#66aa00"></path></g><g><path d="M154,151L79.2172671774217,137.4522004891248A76,76,0,0,1,106.52534134325904,91.65223858117366L154,151A0,0,0,0,0,154,151" stroke="#ffffff" stroke-width="1" fill="#dd4477"></path></g><g><path d="M154,151L78.20684727035388,156.60339176754002A76,76,0,0,1,79.2172671774217,137.4522004891248L154,151A0,0,0,0,0,154,151" stroke="#ffffff" stroke-width="1" fill="#0099c6"></path><path d="M74.21773396879355,156.89830712372634A80,80,0,0,1,75.28133387097022,136.73915840960507" stroke="#0099c6" stroke-width="2" fill-opacity="1" fill="none"></path></g><g><path d="M154,151L79.51951675650146,166.12142902687881A76,76,0,0,1,78.20684727035388,156.60339176754002L154,151A0,0,0,0,0,154,151" stroke="#ffffff" stroke-width="1" fill="#990099"></path></g><g><path d="M154,151L115.7689452511419,216.68398931847713A76,76,0,0,1,79.51951675650145,166.1214290268788L154,151A0,0,0,0,0,154,151" stroke="#ffffff" stroke-width="1" fill="#109618"></path><text text-anchor="start" x="98.64588507718476" y="183.42230489872622" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#ffffff">13.4%</text></g><g><path d="M154,151L192.23105474885807,216.68398931847713A76,76,0,0,1,115.7689452511419,216.68398931847713L154,151A0,0,0,0,0,154,151" stroke="#ffffff" stroke-width="1" fill="#ff9900"></path><text text-anchor="start" x="138.5" y="212.47487623750243" font-family="Arial" font-size="11" stroke="none" stroke-width="0" fill="#ffffff">16.8%</text></g><g></g></svg><div aria-label="A tabular representation of the data in the chart." style="position: absolute; left: -10000px; top: auto; width: 1px; height: 1px; overflow: hidden;"><table><thead><tr><th>Car color</th><th>Quantity</th></tr></thead><tbody><tr><td>Black</td><td>34</td></tr><tr><td>White</td><td>28</td></tr><tr><td>Grey</td><td>25</td></tr><tr><td>Silver</td><td>20</td></tr><tr><td>Green</td><td>3</td></tr><tr><td>Blue</td><td>6</td></tr><tr><td>Red</td><td>17</td></tr><tr><td>Other</td><td>16</td></tr></tbody></table></div></div></div><div aria-hidden="true" style="display: none; position: absolute; top: 310px; left: 410px; white-space: nowrap; font-family: Arial; font-size: 11px; font-weight: bold;">28 (18.8%)</div><div></div></div></div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
            /*
                This script retrieves the towed data information
                from the City of Chicago Data Portal
                
                You are required to enter the information for your vehicle
                as a license plate number
            
            */
            
            var towedVehicle;
            
            $(function(){
                
                $("#submit").click(function(){
                    
                    var html = "";
                    
                    // base URL to the food inspections data
                    var baseURL = 'https://data.cityofchicago.org/resource/rp42-fxjt.json';
                    
                    // optional filters we're appending - date range and zip
                    var filters = "";
                    
                    // full URL
                    var url = baseURL;
                        
                    $.getJSON(url).done (function (data) {
                        // TODO:  add script to add data to the DOM
                        console.log(data);
                        // loop through the records
                        
                        towedVehicle = data;
                        
                        var date = towedVehicle[0].tow_date;

                        var blk = 0, whi = 0, gry = 0, sil = 0, grn = 0, blu = 0, red = 0, oth = 0;
                        
                        if(towedVehicle.length == 0){
                            html = "No Vehicle Reported";
                        } else{
                            $.each(towedVehicle, function(index, value){
                                if(value.tow_date == date){
                                    var col = value.color;
                                    if (col == "BLK")
                                        blk++;
                                    else if(col == "WHI")
                                        whi++;
                                    else if(col == "GRY")
                                        gry++;
                                    else if(col == "SIL")
                                        sil++;
                                    else if(col == "GRN")
                                        grn++;
                                    else if(col == "BLU")
                                        blu++;
                                    else if(col == "RED" || col == "MAR")
                                        red++;
                                    else
                                        oth++;
                                }
                            })  // end of .each loop
                            
                            /*html = "<p>Black: " + blk + "<br>" +
                                    "White: " + whi + "<br>" +
                                    "Grey: " + gry + "<br>" +
                                    "Silver: " + sil + "<br>" +
                                    "Green: " + grn + "<br>" +
                                    "Blue: " + blu + "<br>" +
                                    "Red: " + red + "</p>";*/
                            // Load the Visualization API and the corechart package.
                          google.charts.load('current', {'packages':['corechart']});
                    
                          // Set a callback to run when the Google Visualization API is loaded.
                          google.charts.setOnLoadCallback(drawChart);
                    
                          // Callback that creates and populates a data table,
                          // instantiates the pie chart, passes in the data and
                          // draws it.
                          function drawChart() {
                    
                            // Create the data table.
                            var data = new google.visualization.DataTable();
                            data.addColumn('string', 'Car color');
                            data.addColumn('number', 'Quantity');
                            data.addRows([
                              ['Black', blk],
                              ['White', whi],
                              ['Grey', gry],
                              ['Silver', sil],
                              ['Green', grn],
                              ['Blue', blu],
                              ['Red', red],
                              ['Other', oth]
                            ]);
                    
                            // Set chart options
                            var options = {'title':'Towed cars by color on ' + date,
                                           'width':400,
                                           'height':300};
                    
                            // Instantiate and draw our chart, passing in some options.
                            var chart = new google.visualization.PieChart(document.getElementById('results'));
                            chart.draw(data, options);
                          }
                        }
                        
                        //$("#results").html(html);
                        
                    }) // end of getJSON function
                    
                })  // end of click function
                
            }) // end of ready command
          </script> 
          <script type="text/javascript" src="https://www.gstatic.com/charts/45.1/loader.js"></script>
          </body>
          </html>
            
        